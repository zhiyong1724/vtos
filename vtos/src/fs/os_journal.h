#ifndef __OS_JOURNAL_H__
#define __OS_JOURNAL_H__
#include "fs/os_fs_def.h"
#define JOURNAL_FILE_SIZE (FS_CLUSTER_SIZE * 1024)
typedef uint32(*create_file_callback)(const char *path);
typedef uint32 (*write_file_callback)(void *file, void *data, uint32 len);
struct os_journal
{
	uint32 enable;
	create_file_callback create_file;
	write_file_callback write_file;
	uint32 *buff;
	void *file;
	uint32 index;
};
/*********************************************************************************************************************
* 初始化
* arg1：创建系统文件函数指针
* arg2：写系统文件函数指针
*********************************************************************************************************************/
void os_journal_init(create_file_callback arg1, write_file_callback arg2);
/*********************************************************************************************************************
* 释放资源
*********************************************************************************************************************/
void os_journal_uninit();
/*********************************************************************************************************************
* 开始写日志
*********************************************************************************************************************/
void journal_start();
/*********************************************************************************************************************
* 结束写日志
*********************************************************************************************************************/
void journal_end();
/*********************************************************************************************************************
* 写日志函数
*********************************************************************************************************************/
void journal_write(uint32 id);
/*********************************************************************************************************************
* 创建日志文件
*********************************************************************************************************************/
void journal_create();
/*********************************************************************************************************************
* 重置日志文件
*********************************************************************************************************************/
void journal_reset();
/*********************************************************************************************************************
* 从日志中恢复文件系统
* return：0：需要恢复
*********************************************************************************************************************/
uint32 restore_from_journal();
#endif